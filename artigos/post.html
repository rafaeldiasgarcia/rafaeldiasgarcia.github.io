<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FYL1VH5W53"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-FYL1VH5W53');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carregando... | Rafael Dias Garcia</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>‚úçÔ∏è</text></svg>">
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Space+Grotesk:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Highlight.js for Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/style.css">
    <style>
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .post-container {
            max-width: 850px;
            margin: 20px auto;
            padding: 20px;
        }
        .post-header {
            margin-bottom: 50px;
            text-align: center;
        }
        .post-content {
            font-size: 1.15rem;
            line-height: 1.8;
            color: var(--text-primary);
        }
        .post-content h1, .post-content h2, .post-content h3 {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        .post-content p {
            margin-bottom: 25px;
        }
        .post-content img {
            max-width: 100%;
            border-radius: 12px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .post-content pre {
            background: #f8fafc; /* Fundo claro por padr√£o */
            color: #334155;
            padding: 45px 0 15px 0;
            border-radius: 12px;
            overflow-x: auto;
            margin: 30px 0;
            position: relative;
            border: 1px solid rgba(0,0,0,0.05);
            font-family: 'Fira Code', 'Cascadia Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        /* Tema Escuro para o Bloco de C√≥digo */
        [data-theme="dark"] .post-content pre {
            background: #0b0f1a;
            color: #e2e8f0;
            border-color: rgba(255,255,255,0.08);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        /* Barra de t√≠tulo da janela de c√≥digo */
        .post-content pre::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 35px;
            background: rgba(0,0,0,0.02);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            z-index: 2;
        }

        [data-theme="dark"] .post-content pre::before {
            background: rgba(255,255,255,0.03);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        /* Bot√µes da janela */
        .post-content pre::after {
            content: '';
            position: absolute;
            top: 13px;
            left: 15px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #ff5f56;
            box-shadow: 15px 0 0 #ffbd2e, 30px 0 0 #27c93f;
            z-index: 3;
            opacity: 0.5;
        }

        [data-theme="dark"] .post-content pre::after {
            opacity: 1;
        }

        .post-content pre code {
            display: block;
            padding: 10px 0;
            z-index: 1;
            white-space: pre-wrap;
            word-wrap: break-word;
            background: transparent !important;
        }

        /* Ajustes de cores para o highlight.js - Tema Claro (Melhor Contraste) */
        .hljs-keyword, .hljs-selector-tag { color: #d73a49; font-weight: 600; }
        .hljs-string { color: #032f62; font-weight: 500; }
        .hljs-comment { color: #57606a; font-style: italic; }
        .hljs-title, .hljs-section { color: #6f42c1; font-weight: 600; }
        .hljs-variable, .hljs-template-variable { color: #24292f; }
        .hljs-attr { color: #005cc5; }
        .hljs-number { color: #0550ae; }
        .hljs-type { color: #6f42c1; font-weight: 600; }
        .hljs-params { color: #24292f; }
        .hljs-punctuation, .hljs-operator { color: #24292f; }
        .code-text { color: #24292f; } /* Cor padr√£o do texto do c√≥digo no tema claro */

        /* Ajustes de cores para o highlight.js - Tema Escuro */
        [data-theme="dark"] .hljs-keyword, [data-theme="dark"] .hljs-selector-tag { color: #ff79c6; font-weight: 600; }
        [data-theme="dark"] .hljs-string { color: #f1fa8c; }
        [data-theme="dark"] .hljs-comment { color: #6272a4; font-style: italic; }
        [data-theme="dark"] .hljs-title, [data-theme="dark"] .hljs-section { color: #50fa7b; font-weight: 600; }
        [data-theme="dark"] .hljs-variable, [data-theme="dark"] .hljs-template-variable { color: #f8f8f2; }
        [data-theme="dark"] .hljs-attr { color: #8be9fd; }
        [data-theme="dark"] .hljs-number { color: #bd93f9; }
        [data-theme="dark"] .hljs-type { color: #8be9fd; font-weight: 600; }
        [data-theme="dark"] .hljs-params { color: #f8f8f2; }
        [data-theme="dark"] .hljs-punctuation, [data-theme="dark"] .hljs-operator { color: #f8f8f2; }
        [data-theme="dark"] .code-text { color: #e2e8f0; }

        .code-text {
            white-space: pre-wrap;
            word-wrap: break-word;
            flex: 1;
            padding-right: 15px;
        }

        /* Linha de c√≥digo individual */
        .code-line {
            display: flex;
            padding-right: 20px;
            min-width: 100%;
        }

        /* Coluna dos n√∫meros de linha */
        .line-number {
            display: inline-block;
            width: 3.5rem;
            min-width: 3.5rem;
            text-align: right;
            color: rgba(0,0,0,0.4); /* Aumentado contraste */
            user-select: none;
            padding-right: 1.2rem;
            margin-right: 1rem;
            border-right: 1px solid rgba(0,0,0,0.1); /* Aumentado contraste */
            background: rgba(0,0,0,0.02);
            font-size: 0.8rem;
            font-family: 'Fira Code', monospace;
        }

        [data-theme="dark"] .line-number {
            color: rgba(255,255,255,0.2);
            border-right-color: rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.02);
        }

        /* Efeito de listra na calha */
        .line-number::after {
            content: '';
            position: absolute;
            top: 35px;
            bottom: 0;
            left: 3.4rem;
            width: 2px;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 2px,
                rgba(0,0,0,0.03) 2px,
                rgba(0,0,0,0.03) 4px
            );
            pointer-events: none;
        }

        [data-theme="dark"] .line-number::after {
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 2px,
                rgba(255,255,255,0.05) 2px,
                rgba(255,255,255,0.05) 4px
            );
        }
        .post-content blockquote {
            border-left: 5px solid var(--primary-color);
            padding-left: 25px;
            font-style: italic;
            color: var(--text-muted);
            margin: 40px 0;
        }
        .post-meta {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 10px;
            display: block;
        }
        /* Ajuste para o bot√£o do github no post */
        .post-content .btn-outline-dark {
            border-width: 2px;
            font-weight: 700;
            transition: all 0.3s ease;
        }

        [data-theme="dark"] .post-content .btn-outline-dark {
            color: #f8fafc;
            border-color: #f8fafc;
        }

        .post-content .btn-outline-dark:hover {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white !important;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(13, 110, 253, 0.2);
        }
        .transition-all {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#navbar-main" data-bs-offset="100">

<!-- Navbar -->
<nav id="navbar-main" class="navbar navbar-expand-lg fixed-top">
    <div class="container">
        <a class="navbar-brand fw-bold fs-4" href="../index.html">R<span class="text-primary">D</span>G</a>
        <button class="navbar-toggler border-0 p-0" type="button" id="mobileMenuToggle" aria-label="Menu">
            <div class="hamburger-icon">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="collapse navbar-collapse justify-content-end d-none d-lg-flex" id="navbarNav">
            <ul class="navbar-nav align-items-center gap-3">
                <li class="nav-item"><a class="nav-link px-3" href="../index.html#sobre" data-i18n="nav.about">Sobre</a></li>
                <li class="nav-item"><a class="nav-link px-3" href="../index.html#techs" data-i18n="nav.technologies">Tecnologias</a></li>
                <li class="nav-item"><a class="nav-link px-3" href="../index.html#projetos" data-i18n="nav.projects">Projetos</a></li>
                <li class="nav-item"><a class="nav-link px-3" href="../index.html#experiencia" data-i18n="nav.experience">Experi√™ncia</a></li>
                <li class="nav-item"><a class="nav-link px-3 active" href="index.html" data-i18n="nav.blog">Artigos</a></li>
                <li class="nav-item">
                    <div class="navbar-divider"></div>
                </li>
                <li class="nav-item">
                    <a href="https://github.com/rafaeldiasgarcia" target="_blank" class="nav-icon-link" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="https://www.linkedin.com/in/rafaeldiasgarcia/" target="_blank" class="nav-icon-link" aria-label="LinkedIn">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <button class="theme-toggle" id="themeToggle" aria-label="Alternar tema">
                        <i class="fas fa-moon theme-icon moon"></i>
                        <i class="fas fa-sun theme-icon sun"></i>
                    </button>
                </li>
                <li class="nav-item">
                    <button class="btn btn-primary px-4 py-2 rounded-pill fw-semibold" data-bs-toggle="modal" data-bs-target="#contactModal" data-i18n="nav.contact">
                        Contato
                    </button>
                </li>
                <li class="nav-item position-relative">
                    <button class="language-selector" id="languageSelectorBtn" aria-label="Selecionar idioma">
                        üáßüá∑ <i class="fas fa-chevron-down ms-1"></i>
                    </button>
                    <div class="language-dropdown" id="languageDropdown">
                        <a class="language-dropdown-item" data-lang="pt-BR">
                            <span class="flag">üáßüá∑</span>
                            <span class="lang-name">Portugu√™s</span>
                            <i class="fas fa-check check-icon"></i>
                        </a>
                        <a class="language-dropdown-item" data-lang="en">
                            <span class="flag">üá∫üá∏</span>
                            <span class="lang-name">English</span>
                            <i class="fas fa-check check-icon"></i>
                        </a>
                        <a class="language-dropdown-item" data-lang="es">
                            <span class="flag">üá™üá∏</span>
                            <span class="lang-name">Espa√±ol</span>
                            <i class="fas fa-check check-icon"></i>
                        </a>
                        <a class="language-dropdown-item" data-lang="zh">
                            <span class="flag">üá®üá≥</span>
                            <span class="lang-name">‰∏≠Êñá</span>
                            <i class="fas fa-check check-icon"></i>
                        </a>
                        <a class="language-dropdown-item" data-lang="de">
                            <span class="flag">üá©üá™</span>
                            <span class="lang-name">Deutsch</span>
                            <i class="fas fa-check check-icon"></i>
                        </a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Mobile Menu Sidebar -->
<div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
<div class="mobile-menu-sidebar" id="mobileMenuSidebar">
    <div class="mobile-menu-header">
        <div>
            <h5 class="fw-bold mb-0" data-i18n="mobile.menu">Menu</h5>
            <small class="text-muted" data-i18n="mobile.navigation">Navega√ß√£o</small>
        </div>
        <button class="mobile-menu-close" id="mobileMenuClose">
            <i class="fas fa-times"></i>
        </button>
    </div>
    <div class="mobile-menu-body">
        <nav class="mobile-menu-nav">
            <a href="../index.html#sobre" class="mobile-menu-item">
                <i class="fas fa-user me-2"></i><span data-i18n="nav.about">Sobre</span>
            </a>
            <a href="../index.html#techs" class="mobile-menu-item">
                <i class="fas fa-code me-2"></i><span data-i18n="nav.technologies">Tecnologias</span>
            </a>
            <a href="../index.html#projetos" class="mobile-menu-item">
                <i class="fas fa-folder-open me-2"></i><span data-i18n="nav.projects">Projetos</span>
            </a>
            <a href="../index.html#experiencia" class="mobile-menu-item">
                <i class="fas fa-briefcase me-2"></i><span data-i18n="nav.experience">Experi√™ncia</span>
            </a>
            <a href="index.html" class="mobile-menu-item active">
                <i class="fas fa-newspaper me-2"></i><span data-i18n="nav.blog">Artigos</span>
            </a>
        </nav>
        
        <div class="mobile-menu-social">
            <a href="https://github.com/rafaeldiasgarcia" target="_blank" class="mobile-social-link">
                <i class="fab fa-github"></i>
                <span>GitHub</span>
                <i class="fas fa-arrow-right ms-auto"></i>
            </a>
            <a href="https://www.linkedin.com/in/rafaeldiasgarcia/" target="_blank" class="mobile-social-link">
                <i class="fab fa-linkedin"></i>
                <span>LinkedIn</span>
                <i class="fas fa-arrow-right ms-auto"></i>
            </a>
        </div>
        
        <div class="mobile-menu-footer">
            <button class="mobile-theme-toggle-icon" id="mobileThemeToggle">
                <i class="fas fa-moon theme-icon moon"></i>
                <i class="fas fa-sun theme-icon sun"></i>
            </button>
            <button class="btn btn-primary flex-grow-1 rounded-pill py-2 fw-semibold" data-bs-toggle="modal" data-bs-target="#contactModal">
                <i class="fas fa-paper-plane me-2"></i><span data-i18n="nav.contact">Contato</span>
            </button>
            <div class="mobile-language-selector-wrapper position-relative">
                <button class="mobile-language-toggle-icon" id="mobileLanguageBtn">
                    <span class="flag-emoji">üáßüá∑</span>
                </button>
                <div class="mobile-language-dropdown" id="mobileLanguageDropdown">
                    <a class="mobile-language-dropdown-item" data-lang="pt-BR">
                        <span class="flag">üáßüá∑</span>
                        <span class="lang-name">Portugu√™s</span>
                        <i class="fas fa-check check-icon"></i>
                    </a>
                    <a class="mobile-language-dropdown-item" data-lang="en">
                        <span class="flag">üá∫üá∏</span>
                        <span class="lang-name">English</span>
                        <i class="fas fa-check check-icon"></i>
                    </a>
                    <a class="mobile-language-dropdown-item" data-lang="es">
                        <span class="flag">üá™üá∏</span>
                        <span class="lang-name">Espa√±ol</span>
                        <i class="fas fa-check check-icon"></i>
                    </a>
                    <a class="mobile-language-dropdown-item" data-lang="zh">
                        <span class="flag">üá®üá≥</span>
                        <span class="lang-name">‰∏≠Êñá</span>
                        <i class="fas fa-check check-icon"></i>
                    </a>
                    <a class="mobile-language-dropdown-item" data-lang="de">
                        <span class="flag">üá©üá™</span>
                        <span class="lang-name">Deutsch</span>
                        <i class="fas fa-check check-icon"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="post-container">
    <div class="mb-4">
        <a href="index.html" class="text-muted text-decoration-none hover-primary transition-all d-inline-flex align-items-center">
            <i class="fas fa-arrow-left me-2"></i> Todos os Artigos
        </a>
    </div>

    <div id="loading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Carregando...</span>
        </div>
    </div>

    <article id="post-article" style="display: none;">
        <div class="post-header">
            <span id="post-date" class="post-meta"></span>
            <h1 id="post-title" class="display-4 fw-bold"></h1>
        </div>
        <div id="post-content" class="post-content">
            <!-- Markdown content will be rendered here -->
        </div>
    </article>
</div>

<!-- Contact Modal -->
<div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold d-flex align-items-center text-primary" id="contactModalLabel">
                    <i class="fas fa-paper-plane me-2"></i><span data-i18n="contact.title">Enviar Mensagem</span>
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <!-- Form -->
                <form id="contactForm" action="https://formspree.io/f/xrbqbvyy" method="POST">
                    <div class="mb-3">
                        <label for="email" class="form-label fw-bold text-muted small mb-1" data-i18n="contact.emailLabel">Seu Email</label>
                        <input type="email" class="form-control form-control-lg border-0 bg-light shadow-sm" name="email" id="email" data-i18n-placeholder="contact.emailPlaceholder" placeholder="nome@exemplo.com" required>
                    </div>
                    <div class="mb-4">
                        <label for="message" class="form-label fw-bold text-muted small mb-1" data-i18n="contact.messageLabel">Mensagem</label>
                        <textarea class="form-control form-control-lg border-0 bg-light shadow-sm" name="message" id="message" rows="4" data-i18n-placeholder="contact.messagePlaceholder" placeholder="Como posso ajudar?" required></textarea>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary btn-lg fw-bold rounded-pill shadow-sm" data-i18n="contact.sendButton">Enviar Agora</button>
                    </div>
                </form>

                <!-- Success Message (Hidden by default) -->
                <div id="successMessage" class="text-center py-4 d-none">
                    <div class="mb-4">
                        <i class="fas fa-check-circle text-success fa-4x animate__animated animate__bounceIn"></i>
                    </div>
                    <h4 class="fw-bold text-success mb-2" data-i18n="contact.successTitle">Mensagem Enviada!</h4>
                    <p class="text-muted" data-i18n="contact.successMessage">Obrigado pelo contato. Retornarei em breve.</p>
                    <button type="button" class="btn btn-outline-success rounded-pill mt-3 px-5" data-bs-dismiss="modal" data-i18n="contact.close">Fechar</button>
                </div>

                <!-- Error Message (Hidden by default) -->
                <div id="errorMessage" class="text-center py-4 d-none">
                    <div class="mb-4">
                        <i class="fas fa-exclamation-circle text-danger fa-4x"></i>
                    </div>
                    <h4 class="fw-bold text-danger mb-2" data-i18n="contact.errorTitle">Erro ao enviar</h4>
                    <p class="text-muted" data-i18n="contact.errorMessage">Houve um problema. Tente novamente ou use meu email direto.</p>
                    <button type="button" class="btn btn-outline-secondary rounded-pill mt-3 px-5" onclick="resetForm()" data-i18n="contact.tryAgain">Tentar Novamente</button>
                </div>

            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- Custom JS -->
<script src="../assets/js/script.js"></script>
<!-- i18n JS -->
<script src="../assets/js/i18n.js"></script>

<script>
    async function loadPost() {
        const urlParams = new URLSearchParams(window.location.search);
        const postId = urlParams.get('id');

        if (!postId) {
            window.location.href = 'index.html';
            return;
        }

        try {
            // 1. Get post metadata
            const postsResponse = await fetch('posts.json');
            const posts = await postsResponse.json();
            const postMetadata = posts.find(p => p.id === postId);

            if (!postMetadata) {
                throw new Error('Post n√£o encontrado');
            }

            // 2. Load the markdown file
            const markdownResponse = await fetch(`conteudo/${postMetadata.file}`);
            if (!markdownResponse.ok) throw new Error('Falha ao carregar o arquivo do post');
            const markdown = await markdownResponse.text();

            // 3. Render
            document.title = `${postMetadata.title} | Rafael Dias Garcia`;
            document.getElementById('post-title').textContent = postMetadata.title;
            
            // Parse date manually to avoid timezone shifts (treating as local date)
            const [y, m, d] = postMetadata.date.split('-').map(Number);
            const dateObj = new Date(y, m - 1, d);
            
            document.getElementById('post-date').innerHTML = `<i class="far fa-calendar-alt me-2"></i> ${dateObj.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' })}`;
            
            // Configurar marked para n√£o escapar HTML se houver blocos de c√≥digo
            document.getElementById('post-content').innerHTML = marked.parse(markdown);

            // 4. Adicionar n√∫meros de linha e realce de sintaxe
            document.querySelectorAll('pre code').forEach(block => {
                // 4.1 Aplicar realce de sintaxe
                hljs.highlightElement(block);

                // 4.2 Pegar o HTML gerado pelo highlight.js e dividir em linhas
                const content = block.innerHTML;
                const lines = content.split('\n');
                
                // Remove a √∫ltima linha se estiver vazia
                if (lines.length > 0 && lines[lines.length - 1].trim() === '') {
                    lines.pop();
                }

                const numberedLines = lines.map((line, index) => {
                    // Aqui n√£o escapamos o HTML porque o highlight.js j√° gerou as tags de cor
                    return `<div class="code-line"><span class="line-number">${index + 1}</span><span class="code-text">${line || ' '}</span></div>`;
                }).join('');
                
                block.innerHTML = numberedLines;
            });

            // 5. Show content
            document.getElementById('loading').style.display = 'none';
            document.getElementById('post-article').style.display = 'block';

        } catch (error) {
            console.error('Erro ao carregar the post:', error);
            document.getElementById('loading').innerHTML = `
                <div class="alert alert-danger">
                    <h4 class="alert-heading">Erro!</h4>
                    <p>${error.message}</p>
                    <hr>
                    <a href="index.html" class="btn btn-outline-danger">Voltar para a lista</a>
                </div>
            `;
        }
    }

    loadPost();
</script>
</body>
</html>
